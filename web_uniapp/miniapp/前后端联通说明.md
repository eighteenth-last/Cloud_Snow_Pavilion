# å‰åç«¯æ¥å£è”é€šè¯´æ˜

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ç»Ÿä¸€è¯·æ±‚å°è£…

åˆ›å»ºäº† `utils/request.js` æ–‡ä»¶ï¼Œæä¾›ï¼š
- ç»Ÿä¸€çš„è¯·æ±‚æ‹¦æˆªå™¨
- è‡ªåŠ¨æ·»åŠ  Token åˆ°è¯·æ±‚å¤´ï¼ˆ`Authorization: Bearer {token}`ï¼‰
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- 401 è‡ªåŠ¨è·³è½¬ç™»å½•
- å°è£…äº† `get`ã€`post`ã€`put`ã€`del` æ–¹æ³•

### 2. API æ¥å£ç®¡ç†

åˆ›å»ºäº† `api/index.js` æ–‡ä»¶ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰APIæ¥å£ï¼š

#### è®¤è¯ç›¸å…³ (authApi)
- `getSmsCode(mobile)` - è·å–çŸ­ä¿¡éªŒè¯ç 
- `login(mobile, code)` - æ‰‹æœºå·ç™»å½•
- `wxLogin(code, encryptedData, iv)` - å¾®ä¿¡ç™»å½•
- `logout()` - é€€å‡ºç™»å½•
- `getUserInfo()` - è·å–ç”¨æˆ·ä¿¡æ¯
- `checkLogin()` - æ£€æŸ¥ç™»å½•çŠ¶æ€

#### å•†å“ç›¸å…³ (productApi)
- `getList(categoryId)` - è·å–å•†å“åˆ—è¡¨
- `getPage(current, size, name, categoryId)` - åˆ†é¡µæŸ¥è¯¢
- `getDetail(id)` - è·å–å•†å“è¯¦æƒ…
- `search(keyword)` - æœç´¢å•†å“

#### è®¢å•ç›¸å…³ (orderApi)
- `create(orderData)` - åˆ›å»ºè®¢å•
- `getList(status)` - è·å–è®¢å•åˆ—è¡¨
- `getDetail(id)` - è·å–è®¢å•è¯¦æƒ…
- `cancel(id)` - å–æ¶ˆè®¢å•
- `pay(id)` - æ”¯ä»˜è®¢å•

#### åœ°å€ç›¸å…³ (addressApi)
- `getList()` - è·å–åœ°å€åˆ—è¡¨
- `getDetail(id)` - è·å–åœ°å€è¯¦æƒ…
- `getDefault()` - è·å–é»˜è®¤åœ°å€
- `add(address)` - æ–°å¢åœ°å€
- `update(id, address)` - æ›´æ–°åœ°å€
- `delete(id)` - åˆ é™¤åœ°å€
- `setDefault(id)` - è®¾ç½®é»˜è®¤åœ°å€

#### ä¼˜æƒ åˆ¸ç›¸å…³ (couponApi)
- `getList(status)` - è·å–ä¼˜æƒ åˆ¸åˆ—è¡¨
- `getAvailable()` - è·å–å¯ç”¨ä¼˜æƒ åˆ¸
- `claim(couponId)` - é¢†å–ä¼˜æƒ åˆ¸

#### é—¨åº—ç›¸å…³ (storeApi)
- `getList()` - è·å–é—¨åº—åˆ—è¡¨
- `getDetail(id)` - è·å–é—¨åº—è¯¦æƒ…
- `getNearby(latitude, longitude)` - è·å–é™„è¿‘é—¨åº—

#### ç”¨æˆ·ç›¸å…³ (userApi)
- `getInfo()` - è·å–ç”¨æˆ·ä¿¡æ¯
- `update(userInfo)` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯

### 3. å·²æ›´æ–°çš„é¡µé¢

#### âœ… pages/login/login.vue
- ä½¿ç”¨ `authApi.getSmsCode()` è·å–éªŒè¯ç 
- ä½¿ç”¨ `authApi.login()` ç™»å½•
- è‡ªåŠ¨å¤„ç† token å­˜å‚¨

#### âœ… pages/index/index.vue
- ä½¿ç”¨ `productApi.getList()` åŠ è½½å•†å“
- æ”¯æŒåˆ†ç±»ç­›é€‰
- ä¿®å¤äº†è´­ç‰©è½¦é€»è¾‘

#### âœ… pages/address/list.vue
- ä½¿ç”¨ `addressApi.getList()` åŠ è½½åœ°å€åˆ—è¡¨
- ä½¿ç”¨ `addressApi.delete()` åˆ é™¤åœ°å€
- ç§»é™¤äº†æ‰‹åŠ¨çš„tokenå¤„ç†

### 4. åç«¯æ¥å£è·¯ç”±

æ‰€æœ‰åç«¯APIéƒ½åœ¨ `http://localhost:8080/api` ä¸‹ï¼š

```
/api/auth/*        - è®¤è¯ç›¸å…³
/api/product/*     - å•†å“ç›¸å…³
/api/order/*       - è®¢å•ç›¸å…³
/api/address/*     - åœ°å€ç›¸å…³
/api/coupon/*      - ä¼˜æƒ åˆ¸ç›¸å…³
/api/store/*       - é—¨åº—ç›¸å…³
/api/user/*        - ç”¨æˆ·ç›¸å…³
```

## ğŸ“‹ å¾…æ›´æ–°çš„é¡µé¢

ä»¥ä¸‹é¡µé¢éœ€è¦æ›´æ–°ä¸ºä½¿ç”¨æ–°çš„APIå°è£…ï¼š

### å¾…æ›´æ–°åˆ—è¡¨
- [ ] pages/product/detail.vue - å•†å“è¯¦æƒ…
- [ ] pages/cart/cart.vue - è´­ç‰©è½¦
- [ ] pages/order/list.vue - è®¢å•åˆ—è¡¨
- [ ] pages/order/confirm.vue - ç¡®è®¤è®¢å•
- [ ] pages/order/detail.vue - è®¢å•è¯¦æƒ…
- [ ] pages/address/edit.vue - ç¼–è¾‘åœ°å€
- [ ] pages/coupon/list.vue - ä¼˜æƒ åˆ¸åˆ—è¡¨
- [ ] pages/coupon/claim.vue - é¢†åˆ¸ä¸­å¿ƒ
- [ ] pages/user/index.vue - ä¸ªäººä¸­å¿ƒ

## ğŸ”§ ä½¿ç”¨ç¤ºä¾‹

### åœ¨é¡µé¢ä¸­ä½¿ç”¨API

```javascript
<script>
import { productApi, authApi, orderApi } from '@/api/index.js'

export default {
  async onLoad() {
    // åŠ è½½å•†å“åˆ—è¡¨
    const res = await productApi.getList()
    this.productList = res.data
    
    // åˆ›å»ºè®¢å•
    const orderData = { ... }
    await orderApi.create(orderData)
  }
}
</script>
```

### Tokenè‡ªåŠ¨å¤„ç†

æ— éœ€æ‰‹åŠ¨å¤„ç†tokenï¼Œrequest.jsä¼šè‡ªåŠ¨ï¼š
1. ä»localStorageè¯»å–token
2. æ·»åŠ åˆ°è¯·æ±‚å¤´
3. 401æ—¶è‡ªåŠ¨æ¸…é™¤tokenå¹¶è·³è½¬ç™»å½•

## ğŸš€ ä¸‹ä¸€æ­¥å·¥ä½œ

1. æ›´æ–°å‰©ä½™é¡µé¢ä½¿ç”¨æ–°çš„APIå°è£…
2. å®Œå–„é”™è¯¯å¤„ç†æœºåˆ¶
3. æ·»åŠ è¯·æ±‚åŠ è½½çŠ¶æ€æç¤º
4. å®ç°è¯·æ±‚ç¼“å­˜æœºåˆ¶
5. æ·»åŠ è¯·æ±‚é‡è¯•åŠŸèƒ½

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å¯¼å…¥è·¯å¾„**ï¼šä½¿ç”¨ `@/api/index.js` å¯¼å…¥API
2. **å¼‚æ­¥å¤„ç†**ï¼šæ‰€æœ‰APIè°ƒç”¨éƒ½è¿”å›Promise
3. **é”™è¯¯å¤„ç†**ï¼šå·²åœ¨request.jsä¸­ç»Ÿä¸€å¤„ç†ï¼Œcatchä¸­åªéœ€è®°å½•æ—¥å¿—
4. **Tokenç®¡ç†**ï¼šç™»å½•åè‡ªåŠ¨å­˜å‚¨ï¼Œé€€å‡ºè‡ªåŠ¨æ¸…é™¤
5. **åç«¯URL**ï¼šå½“å‰é…ç½®ä¸º `http://localhost:8080/api`ï¼Œéƒ¨ç½²æ—¶éœ€ä¿®æ”¹
